# ğŸ› ï¸ Tester / Symulator Falownika E3 (Modbus RTU Slave)

## ğŸ“Œ Opis Projektu
Ten projekt jest **cyfrowym bliÅºniakiem (Digital Twin)** falownika przemysÅ‚owego serii E3. ZostaÅ‚ stworzony, aby umoÅ¼liwiÄ‡ bezpieczne testowanie GÅ‚Ã³wnego Regulatora PID "na biurku", bez koniecznoÅ›ci podÅ‚Ä…czania silnikÃ³w, wysokiego napiÄ™cia (230/400V) i fizycznego falownika.

UrzÄ…dzenie dziaÅ‚a na mikrokontrolerze **ESP32-S3** i symuluje zachowanie falownika w sieci **Modbus RTU (RS485)**. Pozwala rÄ™cznie sterowaÄ‡ "wirtualnÄ… czÄ™stotliwoÅ›ciÄ…" silnika, na co GÅ‚Ã³wny Regulator musi odpowiednio zareagowaÄ‡ (np. wÅ‚Ä…czajÄ…c/wyÅ‚Ä…czajÄ…c przekaÅºniki w trybie AUTO).

---

## ğŸš€ GÅ‚Ã³wne Funkcje
1.  **Symulacja Modbus Slave:** UrzÄ…dzenie nasÅ‚uchuje zapytaÅ„ od Mastera (Regulatora) pod adresem ID `1`.
2.  **Rejestr CzÄ™stotliwoÅ›ci:** Symuluje rejestr `0x1000` (Output Frequency), zwracajÄ…c wartoÅ›Ä‡ w skali x100 (np. `5000` = 50.00 Hz).
3.  **Sterowanie Fizyczne:** Dwa przyciski (GÃ“RA/DÃ“Å) pozwalajÄ… uÅ¼ytkownikowi zmieniaÄ‡ symulowanÄ… prÄ™dkoÅ›Ä‡ silnika w czasie rzeczywistym.
4.  **Logowanie UART:** PodglÄ…d aktualnych parametrÃ³w pracy w terminalu szeregowym.

---

## âš™ï¸ Wymagania SprzÄ™towe
* **Mikrokontroler:** ESP32-S3 (DevKitC-1)
* **Komunikacja:** ModuÅ‚ konwertera UART <-> RS485 (np. MAX485 lub izolowany moduÅ‚ przemysÅ‚owy).
* **Interfejs:** 2x przycisk tact-switch (zwierny).
* **Zasilanie:** USB-C lub 5V.

---

## ğŸ”Œ Schemat PoÅ‚Ä…czeÅ„ (Pinout)

### 1. ModuÅ‚ RS485
| Pin ESP32-S3 | Pin ModuÅ‚u RS485 | Funkcja |
| :--- | :--- | :--- |
| **GPIO 16** | **RO** (RX) | OdbiÃ³r danych z magistrali |
| **GPIO 17** | **DI** (TX) | Nadawanie danych na magistralÄ™ |
| **GPIO 4** | **DE** oraz **RE** | Sterowanie nadawaniem (zwarte razem) |
| **5V / 3.3V** | **VCC** | Zasilanie moduÅ‚u |
| **GND** | **GND** | WspÃ³lna masa (Krytyczne!) |

### 2. Przyciski SterujÄ…ce
| Pin ESP32-S3 | Element | Konfiguracja | Funkcja |
| :--- | :--- | :--- | :--- |
| **GPIO 18** | Przycisk 1 | Zwiera do GND | **ZwiÄ™ksz Hz (+5.00)** |
| **GPIO 19** | Przycisk 2 | Zwiera do GND | **Zmniejsz Hz (-5.00)** |

> **UWAGA:** Przyciski korzystajÄ… z wewnÄ™trznych rezystorÃ³w podciÄ…gajÄ…cych (`INPUT_PULLUP`). DrugÄ… nÃ³Å¼kÄ™ przycisku naleÅ¼y podÅ‚Ä…czyÄ‡ bezpoÅ›rednio do **GND**.

---

## ğŸ“¡ Parametry Transmisji (Modbus RTU)
Aby GÅ‚Ã³wny Regulator poprawnie skomunikowaÅ‚ siÄ™ z Testerem, muszÄ… one mieÄ‡ identyczne ustawienia:

* **Baud Rate:** 9600
* **Data Bits:** 8
* **Stop Bits:** 1
* **Parity:** None (Brak)
* **ProtokÃ³Å‚:** Modbus RTU (Serial 8N1)
* **Slave ID:** 1
* **Holding Register:** `0x1000` (4096 dec)

---

## ğŸ’» Konfiguracja Programowa (PlatformIO)

Projekt wykorzystuje Å›rodowisko **PlatformIO**. PoniÅ¼ej znajduje siÄ™ poprawna konfiguracja pliku `platformio.ini` dla ESP32-S3.

**UÅ¼yta biblioteka:** `emelianov/modbus-esp8266` (ObsÅ‚uguje zarÃ³wno ESP8266 jak i ESP32).

```ini
[env:esp32-s3-devkitc-1]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
monitor_speed = 115200

; Biblioteka do obsÅ‚ugi Modbus RTU Slave
lib_deps = 
    emelianov/modbus-esp8266

; Flagi wymagane dla poprawnego dziaÅ‚ania USB Serial w S3
build_flags = 
    -D ARDUINO_USB_MODE=1
    -D ARDUINO_USB_CDC_ON_BOOT=1
