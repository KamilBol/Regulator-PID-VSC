 INSTRUKCJA: LOGOWANIE DANYCH NA SD (ESP32-S3)
Aby karta SD dziaaa stabilnie, zapisywaa pliki .csv i nie sypaa bdami Mount Failed, musisz speni te 3 zasady:

1. ZASADA FIZYCZNA (Format i Piny)
To jest najczstszy pow贸d bdu (13) There is no valid FAT volume.

SYSTEM PLIKW: Karta MUSI by sformatowana w FAT32.

Format exFAT (domylny dla kart >32GB) NIE ZADZIAA.

Format NTFS NIE ZADZIAA.

ROZMIAR: Najlepiej u偶ywa kart od 4GB do 32GB. Jeli masz kart 64GB+, musisz u偶y programu GUIFormat na Windows, aby wymusi FAT32.

ALOKACJA: Przy formatowaniu wybierz "Rozmiar jednostki alokacji" na 32 kilobajty (32768).

PINOLOGIA (SPI dla Twojego projektu):

CS (Chip Select): Pin 15

SCK (Clock): Pin 16

MOSI (Data Out): Pin 17

MISO (Data In): Pin 18

2. ZASADA PROGRAMOWA (Inicjalizacja SPI)
ESP32-S3 ma piny SPI w innym miejscu ni偶 "zwyke" ESP32. Biblioteka SD.h o tym nie wie, wic szuka karty tam, gdzie jej nie ma.

Rozwizanie: Musisz rcznie uruchomi magistral SPI na swoich pinach PRZED uruchomieniem karty SD.

Kod Inicjalizacji (Setup):

C++
#include <SPI.h>
#include <SD.h>

#define SD_CS   15
#define SD_SCK  16
#define SD_MOSI 17
#define SD_MISO 18

void setup() {
    Serial.begin(115200);

    // KROK 1: Rczne przypisanie pin贸w SPI
    // Bez tej linijki ESP32-S3 nie znajdzie czytnika!
    SPI.begin(SD_SCK, SD_MISO, SD_MOSI, SD_CS);

    // KROK 2: Start Karty
    if (!SD.begin(SD_CS)) {
        Serial.println("BD SD: Sprawd藕 format FAT32 i kable!");
        return;
    }
    
    // Opcjonalnie: Sprawdzenie typu karty
    uint8_t cardType = SD.cardType();
    if(cardType == CARD_NONE) {
        Serial.println("Nie wykryto karty fizycznie");
        return;
    }
    
    Serial.println("SD OK - Gotowa do pracy");
}
3. ZASADA ZAPISU (Otw贸rz -> Zapisz -> Zamknij)
Nigdy nie trzymaj pliku otwartego przez cay czas pracy programu. Jeli braknie prdu, stracisz dane.
Zasada jest prosta: Otwierasz plik tylko na uamek sekundy, dopisujesz linijk i natychmiast zamykasz.

Wz贸r funkcji Logujcej (Loop):

C++
void logujDane(float napiecie, float prad) {
    // 1. Otwieramy plik w trybie DOPISYWANIA (FILE_APPEND)
    // Jeli plik nie istnieje, biblioteka sama go stworzy.
    File plik = SD.open("/pomiary.csv", FILE_APPEND);

    if (plik) {
        // 2. Tworzymy lini tekstu (CSV - wartoci oddzielone rednikiem)
        // Przykad: "12500;230.5;5.120"
        String linia = String(millis()) + ";" + String(napiecie, 1) + ";" + String(prad, 3);
        
        // 3. Zapisujemy i ZAMYKAMY (Zapis fizyczny nastpuje przy close)
        plik.println(linia);
        plik.close(); 
        
        Serial.println("Zapisano: " + linia);
    } else {
        Serial.println("Bd otwarcia pliku!");
    }
}
Najczstsze bdy (Troubleshooting):
Mount Failed / Error 13: Karta ma zy format (exFAT/NTFS). Sformatuj na FAT32.

Pusty plik: Zapomniae doda plik.close(). Dane wisiay w buforze i nie trafiy na kart.

System wisi: Pr贸bujesz zapisywa zbyt czsto (np. co 10ms). Karta SD jest wolna. Zapisuj dane co 1-2 sekundy.
